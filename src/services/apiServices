
import { AppError } from "../utils/errorHandlers.js";
import { Country } from "../models/country.js";

const BASE_URL = 'https://restcountries.com/v3.1';


export const fetchCountry = async (): Promise<Country[]> => {
    try {
        const response = await fetch
            ("https://restcountries.com/v3.1/all?status=true&fields=name,popultion,region,capital,flag,nativeName,subregion,currencies,languages,borders")

        if (!response.ok) {
            throw new AppError("Failed to fetch Countries", response.status)
        }

        //Convert response body to JSON
        const data = await response.json();
        return data.map((c: any) => new Country(c));

    } catch (error: any) {
        if (error instanceof AppError) {
            throw error
        } else {
            throw new error("unexpected error:" + error)
        }
    }

}
